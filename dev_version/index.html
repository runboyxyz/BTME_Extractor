<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />
  <title>Extract Highfreq Audible — BTME Extractor (Hilbert Demod)</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-header">
    <h1>Extract Highfreq Audible <span class="sub">BTME Extractor</span></h1>
    <div class="credit">© 2025 Discord user <strong>Runboy</strong></div>
  </header>

  <main class="container">
    <section class="panel">
      <h2>Upload & Presets</h2>
      <div class="field">
        <label for="file">Audio file (prefer 48 kHz WAV)</label>
        <input id="file" type="file" accept=".wav,.mp3,.m4a,.flac,.ogg,.aac,audio/*" />
      </div>

      <div class="button-row">
        <button id="btn1m" class="btn secondary">Load 1-minute defaults</button>
        <button id="btn3m" class="btn secondary">Load 3-minute defaults</button>
      </div>
    </section>

    <section class="panel">
      <h2>Timeframe</h2>
      <div class="grid two">
        <div class="field">
          <label for="t0">Start (t0, seconds)</label>
          <input id="t0" type="number" step="0.1" placeholder="e.g. 38" />
        </div>
        <div class="field">
          <label for="t1">End (t1, seconds — blank = end)</label>
          <input id="t1" type="number" step="0.1" placeholder="e.g. 42" />
        </div>
      </div>
    </section>

    <section class="panel">
      <h2>DSP (Hilbert Demodulation → Baseband)</h2>
      <p class="explain">
        This build isolates the ultrasonic band, forms the analytic signal, and
        <em>rotates</em> it to baseband with a complex exponential. Unlike
        simple mixing, true Hilbert demodulation delivers a single, clean
        sideband (no mirrored copy), which reduces musical bleed and
        improves intelligibility.
      </p>

      <div class="grid three">
        <div class="field">
          <label for="hp">Band-pass: Low cut (Hz)</label>
          <input id="hp" type="number" step="10" placeholder="20200" />
        </div>
        <div class="field">
          <label for="preLP">Band-pass: High cut (Hz)</label>
          <input id="preLP" type="number" step="10" placeholder="23800" />
        </div>
        <div class="field">
          <label for="shift">LO / shift (Hz)</label>
          <input id="shift" type="number" step="10" placeholder="22050" />
        </div>
      </div>

      <div class="grid three">
        <div class="field">
          <label for="lp">Post low-pass (Hz)</label>
          <input id="lp" type="number" step="50" placeholder="5200" />
        </div>
        <div class="field">
          <label for="gain">Gain (dB)</label>
          <input id="gain" type="number" step="1" placeholder="12" />
        </div>
        <div class="field">
          <label for="fade">Fade-in (ms)</label>
          <input id="fade" type="number" step="1" placeholder="10" />
        </div>
      </div>

      <div class="grid two">
        <div class="field">
          <label for="outsr">Output sample rate (Hz)</label>
          <input id="outsr" type="number" step="50" placeholder="22050" />
        </div>
        <div class="field">
          <label for="enableDSP">Enable DSP</label>
          <select id="enableDSP">
            <option value="1" selected>On</option>
            <option value="0">Off (trim only)</option>
          </select>
        </div>
      </div>
    </section>

    <section class="panel">
      <h2>Run</h2>
      <!-- Buttons on the same line -->
      <div class="button-row">
        <button id="preview" class="btn primary">Preview</button>
        <button id="process" class="btn primary">Process &amp; Download</button>
      </div>

      <div class="status-row">
        <span id="status" class="status">Javascript not running yet…</span>
      </div>

      <h3>Log</h3>
      <pre id="log" class="log" aria-live="polite">(log)</pre>
    </section>

    <section class="panel">
      <h2>Notes</h2>
      <ul class="notes">
        <li>Use a <strong>48 kHz</strong> source file to retain the ultrasonic band.</li>
        <li>Recommended bands for BTME material:
          <strong>Low</strong> ~20.2 kHz, <strong>High</strong> ~23.8 kHz;
          <strong>LO</strong> ~22.05 kHz; <strong>Post-LP</strong> ~5.2 kHz.</li>
        <li>Defaults: 1-minute (38–42 s), 3-minute (173–177 s).</li>
        <li id="platformHint">Platform tip…</li>
      </ul>
      <p class="legal">
        This tool is for educational and research use. Only process audio you have the
        rights to use. Do not use this tool to violate terms of service, copyright,
        or applicable law.
      </p>
    </section>
  </main>

  <!-- Load order matters: dsp.js BEFORE app.js -->
  <script src="dsp.js"></script>
  <script src="app.js"></script>
</body>
</html>
